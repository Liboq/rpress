<!DOCTYPE html>
<html lang="en" class="w-[100rem]">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>push ä»£ç åˆ° Github è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨</title>
    <link rel="stylesheet" href="../css/pico.min.css">
</head>

<body>

    <main id="container">
        <nav>
            <ul>
                <li><a href="/rpress/index.html">é¦–é¡µ</a></li>
                <li>
                    <details role="list">
                        <summary aria-haspopup="listbox" role="button">
                            æ–‡ç« 
                        </summary>
                        <ul role="listbox">
                            <li><a href="/rpress/tag.html">æ ‡ç­¾</a></li>
                            <li><a href="/rpress/category.html">ç±»å‹</a></li>
                        </ul>
                    </details>
                </li>
                <li><a href="/rpress/about.html">å…³äº</a></li>
            </ul>
            <ul>
                <li><a href="/rpress/friend.html">å‹é“¾</a></li>
            </ul>
        </nav>
        <h1 align="center" id="push ä»£ç åˆ° Github è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨">push ä»£ç åˆ° Github è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨</h1>
        <p align="center">
            <small>
                <span>2023-08-04 |</span>
            </small>
            <a href="/rpress/category.html">FE |</a>
            
            <a href="/rpress/tag.html">å·¥å…·</a>
            
        </p>

        <article>
            <h1>CICD</h1>
<aside>
ğŸ˜€ pushä»£ç åˆ°Github è‡ªåŠ¨åŒ–éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨
</aside>
<h2>Workflow</h2>
<p>å·¥ä½œæµ</p>
<h2>æµç¨‹</h2>
<p>main.yml</p>
<p>äº†è§£ å…³é”®è¯çš„å¤§æ¦‚æ„æ€</p>
<p><img src="../static/image_(18).png" alt="image (18).png" /></p>
<h1>github Action å®è·µ</h1>
<p>åœ¨é¡¹ç›®çš„ Actions ä¸­ ç‚¹å‡» New workflow</p>
<p><img src="../static/image_(19).png" alt="image (19).png" /></p>
<p>é€‰æ‹©ä¸€ä¸ªå·¥ä½œæµç¨‹ï¼Œæˆ‘æ˜¯è‡ªå·±å®šä¹‰ä¸€ä¸ª workflow</p>
<p><img src="../static/image_(20).png" alt="image (20).png" /></p>
<h3>yml å…·ä½“ä»£ç </h3>
<pre><code class="language-tsx">name: æ‰“åŒ…åº”ç”¨å¹¶ä¸Šä¼ æœåŠ¡å™¨

on:
    push:
        branches:
            - master

jobs:
    build:
        # runs-on æŒ‡å®šjobä»»åŠ¡è¿è¡Œæ‰€éœ€è¦çš„è™šæ‹Ÿæœºç¯å¢ƒ(å¿…å¡«å­—æ®µ)
        runs-on: ubuntu-latest
        steps:
            # è·å–æºç 
            - name: è¿å‡ºä»£ç 
              # ä½¿ç”¨actionåº“  actions/checkoutè·å–æºç 
              uses: actions/checkout@master
            - name: å®‰è£…pnpm
              uses: pnpm/action-setup@v2
              with:
                   version: 8
            # # å®‰è£…Node16
            - name: å®‰è£…node.js
            # # ä½¿ç”¨actionåº“  actions/setup-nodeå®‰è£…node
              uses: actions/setup-node@v2.5.1
              with:
                   node-version: '16.x'
                   cache: 'pnpm' #ç¼“å­˜

            # å®‰è£…ä¾èµ–
            - name: å®‰è£…ä¾èµ–
              run: pnpm  install

            # æ‰“åŒ…
            - name: æ‰“åŒ…
              run:  pnpm  build

            # # ä¸Šä¼ è…¾è®¯äº‘
            # - name: å‘å¸ƒåˆ°è…¾è®¯äº‘
            #   uses: easingthemes/ssh-deploy@v2.1.1
            #   env:
            #       # ç§é’¥
            #       SSH_PRIVATE_KEY: ${{ secrets.PRIVATE_KEY }}
            #       # scpå‚æ•°
            #       ARGS: '-avzr --delete'
            #       # æœåŠ¡å™¨ipï¼šæ¢æˆä½ çš„æœåŠ¡å™¨IP
            #       REMOTE_HOST: ${{ secrets.REMOTE_HOST }}
            #       # ç”¨æˆ·
            #       REMOTE_USER: 'root'
            #       # å¯¹åº”æˆ‘ä»¬é¡¹ç›®buildçš„æ–‡ä»¶å¤¹è·¯å¾„
            #       local_path: './dist/*'
            #       # ç›®æ ‡åœ°å€
            #       TARGET: '/www/wwwroot/qiankun-example'

            # åˆ©ç”¨actionæŠŠdistå¥½çš„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨/www/wwwroot/cms.panjingyi.topè·¯å¾„ä¸‹,éœ€è¦ç¡®è®¤æ­¤ç›®å½•å·²åœ¨æœåŠ¡ç«¯åˆ›å»º
            - name: å‘å¸ƒåˆ°è…¾è®¯äº‘
              uses: wlixcc/SFTP-Deploy-Action@v1.0
              with:
                username: 'root' #ssh user name
                server: '${{ secrets.REMOTE_HOST }}' #å¼•ç”¨ä¹‹å‰åˆ›å»ºå¥½çš„secret
                ssh_private_key: ${{ secrets.PRIVATE_KEY }} #å¼•ç”¨ä¹‹å‰åˆ›å»ºå¥½çš„secret
                local_path: './dist/*' # å¯¹åº”æˆ‘ä»¬é¡¹ç›®buildçš„æ–‡ä»¶å¤¹è·¯å¾„
                remote_path: '/www/wwwroot/qiankun-example'

</code></pre>
<p>REMOTE_HOST</p>
<p>PRIVATE_KEY</p>
<p>è¿™ä¸¤ä¸ªå­—æ®µå…ˆåœ¨ é¡¹ç›®çš„ setting/Secrets and variables ä¸­å®šä¹‰</p>
<p><img src="../static/image_(21).png" alt="image (21).png" /></p>
<h1>success</h1>
<p><img src="../static/image_(22).png" alt="image (22).png" /></p>
<aside>
ğŸ’¡ æ¬¢è¿æ‚¨åœ¨åº•éƒ¨è¯„è®ºåŒºç•™è¨€ï¼Œä¸€èµ·äº¤æµ~
</aside>

        </article>
    </main>
    <div id="commit">
        <script src="https://giscus.app/client.js" data-repo="Liboq/rpress" data-repo-id="R_kgDOKmwZyA"
            data-category="Show and tell" data-category-id="DIC_kwDOKmwZyM4Cal6C" data-mapping="url" data-strict="0"
            data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom"
            data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async>
            </script>
    </div>
</body>

</html>